# Численные методы решения нелинейных уравнений

В лекции будут рассматриваться уравнения вида $f(x^*) = 0$, где $x, f \in \mathbb{R}$, а также $x^* = \varphi(x^*)$. Подразумевается, что корень у функции один и существует. Кроме того подразумевается, что функция $f$ нелинейная.

Представление корня будет искаться итеративно. Так, будет некоторое начальное приближение $x_0$, а методы будут вычислять последовательность, которая сходится к $x^*$:

$\lim_{n\rightarrow\infty} x_n = x^*$ 

Найти точное значение корня в общем случае не представляется возможным, так как

* Точный корень может не иметь арифметического выражения
* В машинной арифметике присутствуют погрешности

Введем понятия прямой и обратной ошибки.

Прямая ошибка: $\Delta f = |f(x_n)|$ 

Обратная ошибка: $\Delta x = |x_n - x^*|, \epsilon_x = \Delta x / x$ (относительная обратная ошибка)

### Метод половинного деления

Метод деления пополам позволяет исключать в точности половину интервала на каждой итерации. 

При использовании метода считается, что функция непрерывна и имеет на концах интервала разный знак, что гарантирует наличие хотя бы одного корня на интервале.

> Метод каждый раз делит отрезок на два равных (добавляется новая серединная точка) и для следующей итерации выбирает тот, в котором значения функции на концах отличаются по знаку. Так продолжается до тех пор, пока в серединной точке значение функции не станет по модулю меньше, чем установленная погрешность.

Рассмотрим процесс построения последовательности. За начальную точку берется середина некоторого отрезка $[L_0, R_0]$, который удовлетворяет условию: $sign(f(L_0)) \neq sign(f(R_0))$.

<img src=".\sources\LETI5\x0l0r0.png" alt="x0l0r0" style="zoom:25%;" />

Далее возможны три случая на каждой итерации:

* Если $sign(f(L_n)) \neq sign(f(x_n))$

<img src=".\sources\LETI5\bisect1.png" alt="bisect1" style="zoom:25%;" />

* Если $sign(f(x_n)) \neq sign(f(R_n))$

  <img src=".\sources\LETI5\bisect2.png" alt="bisect2" style="zoom:25%;" />

* $x^*=x_n$

Метод половинного деления может работать достаточно долго, так как на каждом шаге отрезок, на котором может быть корень, уменьшается всего в два раза. Иначе говоря, обратная ошибка на шаге $n$:

<img src=".\sources\LETI5\bisect-err.png" alt="bisect-err" style="zoom:25%;" />

Такая сходимость является *линейной*, то есть *сходимостью порядка 1*.

При использовании мантиссы преставления корня размером 52 бит, в худшем случае потребуется 52 итерации, чтобы получить корень. Это медленно, поэтому метод применяется крайне редко.

### Метод простой итерации

Вспомним представление нелинейного уравнения как $x^*=\varphi(x^*)$. Построение последовательности в методе простой итерации эту формулу напоминает:

$x_{n+1} = \varphi(x_n)$

> Берется некоторое начальное приближение. На каждом следующем шаге применяем функцию $\varphi$ к предыдущей аппроксимации. Визуально это выглядит как "ступеньки" между функцией $y=\varphi(x)$ и $y=x$. Не всегда сходится.

<img src="D:\Github\Dynamic-systems-modeling-course\sources\LETI5\iter4types.png" alt="iter4types" style="zoom:50%;" />

Если функция $\varphi(x)$ - сжимающее отображение, то есть $\varphi'(x) \le k < 1$, то $\lim_{n \rightarrow \infty} x_n = x^*$.

##### Пример: уравнение Кеплера для эллипса

$E = M + e \sin E \ [= \varphi(E)], e<1$

$\varphi' = e \cos E \le e < 1$

$E$ - эксцентрическая аномалия

$M$ - средняя аномалия

Тогда метод будет рассчитывать последовательность:

<img src=".\sources\LETI5\kerpler-iter.png" alt="kerpler-iter" style="zoom:25%;" />

Иллюстрация "а" на рисунке 1.11 выше иллюстрирует работу метода на подобном уравнении.

Поговорим о сходимости метода.

 Учитывая, что $\varphi'(x) \le k < 1$, получаем, что

<img src=".\sources\LETI5\xnp1phixn-fix.png" alt="xnp1phixn-fix" style="zoom:25%;" />

Таким образом, последовательность убывает, то есть действительно  $\lim_{n \rightarrow \infty} x_n = x^*$.

*Порядок сходимости $q$:*

<img src=".\sources\LETI5\order-of-converg.png" alt="order-of-converg" style="zoom:25%;" />

* Если $\varphi'$ определена и непрерывна:

<img src=".\sources\LETI5\fp-lim1.png" alt="fp-lim1" style="zoom:25%;" />

Таким образом, порядок сходимости - 1.

* Если $\varphi'(x^*) = 0$, $\varphi''$ определена и непрерывна:

Используем разложение в ряд Тейлора:

<img src=".\sources\LETI5\phixn-exp.png" alt="phixn-exp" style="zoom:25%;" />

Тогда, полагая $q = 2$:

<img src=".\sources\LETI5\fp-lim2.png" alt="fp-lim2" style="zoom:25%;" />

Предел существует, значит при соблюдении вышеупомянутых условий порядок сходимости метода - 2.

### Метод Ньютона

