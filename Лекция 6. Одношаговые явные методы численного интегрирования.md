# Одношаговые явные методы численного интегрирования

### Задача численного интегрирования

Найти численное значение функции $x(t)$, пользуясь некоторой функцией ее производной:

$x(t) \stackrel{f}{\rightarrow} x(t+h)$

$\dot{x} = f(x)$

**Одношаговые методы** работают тем способом, что при вычислении значения функции в точке $x(t+h)$ используют исключительно значение $x(t)$ (то есть значение на предыдущем шаге) и некоторое количество вызовов функции $f(x)$.

Такое семейство методов называется методами Рунге-Кутты.

### Явные методы Рунге-Кутты: общий принцип

Общий принцип таков: есть $s$ этапов, на каждом из которых происходит один вызов функции $f$. 

$k_1 = f(x(t))$

$k_2 = f(x(t)+ha_{21}k_1)$

$k_3 = f(x(t) + ha_{31}k_1 + ha_{32}k_2)$

$...$

$k_s = f(x(t) + h\sum_{i=1}^{s-1} a_{si}k_i)$

Тогда окончательное значение функции $x(t+h)$:

$x(t+h) = x(t)+h\sum_{i=1}^s b_i k_i [+\varepsilon]$

Как правило, эта формула неточна, это численная аппроксимация с некоторой ошибой, которую обозначаем как $\varepsilon$.

### Таблицы Бутчера

Для упрощения записи конкретных методов семейтсва Рунге-Кутты существуют таблицы Бутчера - это таблицы коэффициентов:

<img src=".\sources\LETI3\butcher-explicit.png" alt="butcher-explicit" style="zoom:30%;" />



Для понимания того, как записывается таблица, стоит внимательно посмотреть на *общий принцип* в предыдущем пункте.

На $i$-том этапе имеем $i-1$ коэффициентов, которые участвуют в линейной комбинации для вычисления $k_i$. Также имеем члены $b_1, b_2, ... b_s$, которые используются при вычислении $x(t+h)$. 

>  Нули на диагонали символизируют тот факт, что при обращении к $f$ в линейной комбинации, которая подается ей как аргумент, не используем результат самой функции $f$. Если бы было не так, то получилась бы система уравнений относительно $k_i$. Именно так происходит в методах, которые называются **неявными**, более того, в этих методах значения выше диагонали также могут быть ненулевыми.

### Явные методы Рунге-Кутты: примеры

#### Метод Эйлера

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-euler.png" alt="butcher-euler" style="zoom:33%;" />

Функция $f$ вызывается всего один раз. Метод имеет *первый порядок*.

Восстановим по таблице формулу для $x(t+h)$. 

* Первая строка характеризует вычисление единственного коэффициента $k_1$:

$k_1=f(x(t))$

* Вторая строка содержит значение $b_1$ для окончательной формулы:

$x(t+h) = x(t) + hb_1k_1=x(t)+hf(x(t))+o(h)$

$o(h)$ - порядок ошибки.



#### Метод средней точки

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-midpoint.png" alt="butcher-midpoint" style="zoom:30%;" />

Функция $f$ вызывается два раза. Метод имеет *второй порядок*.

Восстановим по таблице формулу для $x(t+h)$

* Первая строка характеризует вычисление $k_1$ (как можно заметить, во всех методах вычисление $k_1$ одинаково)

$k_1=f(x(t))$

* Вторая строка содержит коэффициенты для вычисления $k_2$

$k_2 = f\left(x(t)+\dfrac{1}{2}hk_1\right) = f\left(x(t) + \dfrac{h}{2}hf(x(t))\right)$

* Третья строка содержит коэффициенты $b_1, b_2$ для окончательной формулы:

$x(t+h)=x(t)+hf\left(x(t) + \dfrac{h}{2}f(x(t))\right)+o(h^2)$

$o(h^2)$ - порядок ошибки



#### Классический метод Рунге-Кутты 4-го порядка (РК4)

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-rk4.png" alt="butcher-rk4" style="zoom:30%;" />

Запишем уравнения для $k_1, k_2, k_3, k_4$:

$k_1=f(x(t))$

$k_2=f\left(x(t)+\dfrac{h}{2}k_1\right)$

$k_3=f\left(x(t)+\dfrac{h}{2}k_2\right)$

$k_4=f\left(x(t)+hk_3\right)$

Конечная формула для $x(t+h)$:

$x(t+h) = x(t)+h\left(\dfrac{1}{6}k_1+\dfrac{1}{3}k_2+\dfrac{1}{3}k_3+\dfrac{1}{6}k_4\right) + o(h^4)$

### Многообразие явных методов Рунге-Кутты

Методов одинакового порядка может быть множество - можно варьировать значения коэффициентов в таблице Бутчера. Приведем несколько примеров.

#### Метод Хойна (порядок 2)

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-heun.png" alt="butcher-heun" style="zoom:30%;" />

#### Метод Ралстона (порядок 2)

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-ralston2.png" alt="butcher-ralston2" style="zoom:30%;" />

Отличается тем, что имеем **минимальную теоретическую оценку ошибки** среди методов 2-го порядка.

#### Метод Ралстона (порядок 3)

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-ralston3.png" alt="butcher-ralston3" style="zoom:30%;" />

Также имеем **минимальную теоретическую оценку ошибки** среди методов 3-го порядка.

Количество вызовов правых частей $f$ называется **рангом** метода, который, однако, не всегда совпадает с порядком.

#### Метод 3/8 (порядок 4)

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-rk38.png" alt="butcher-rk38" style="zoom:30%;" />

Имеет лучшую теоретическую оценку ошибки, чем *классический РК4*, рассмотренный ранее.

Стоит отметить, что это в любом случае $o(h^4)$, но математически оценка коэффициентов для ошибки меньше.

#### Метод Ралстона (порядок 4)

Таблица Бутчера для метода:

<img src=".\sources\LETI3\butcher-ralston4.png" alt="butcher-ralston4" style="zoom:30%;" />

Выглядит не очень презентабельно, но метод имеет **минимальную теоретическую оценку** ошибки среди методов 4-го порядка.

### Явные методы Рунге-Кутты высших порядков

Отметим несколько важных свойств:

* При порядке $n>4$ **обязательно** ранг $s>n$
* При $n>6$ **обязательно** $s>n+1$
* При $n>7$ **обязательно** $s>n+2$

#### Метод Рунге-Кутты-Фельберга 5-го порядка

Таблица Бутчера для метода:

<img src=".\sources\LETI3\rkf5.png" alt="rkf5" style="zoom:40%;" />

#### Метод Дормана-Принса 5-го порядка

Таблица Бутчера для метода:

<img src=".\sources\LETI3\dopri5.png" alt="dopri5" style="zoom:40%;" />

Является более выгодным с точки зрения ошибки, чем метод РКФ5.

#### Другие явные методы высших порядков

Также известны методы:

* Метод Фельберга 8-го порядка
* Метод Дормана-Принса 8-го порядка (DOPRI8)
* Методы 10-го порядка (редко применяются)

На практике для порядков выше 8 используются неявные методы Рунге-Кутты или неявные многошаговые методы. Причина заключается в том, что при увеличении порядка явные методы сталкиваются с проблемами численной неустойчивости и численных артефактов.